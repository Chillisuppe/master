<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>StormFlash2d: misc_eqsource Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">StormFlash2d
   </div>
   <div id="projectbrief">An Adaptive two-dimensional Discontinuous Galerkin Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacemisc__eqsource.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">misc_eqsource Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>reads pre-calculated uplift from a COARDS-file  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmisc__eqsource_1_1fault.html">fault</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">type definition for a fault description  <a href="structmisc__eqsource_1_1fault.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a94e17f7399f426868d95616b0ae34be0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a94e17f7399f426868d95616b0ae34be0">initialize_source</a> (c_filename, r_dummy1, r_dummy2, i_dummy1, i_dummy2, i_dummy3)</td></tr>
<tr class="memdesc:a94e17f7399f426868d95616b0ae34be0"><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes the source and uplift  <a href="#a94e17f7399f426868d95616b0ae34be0">More...</a><br /></td></tr>
<tr class="separator:a94e17f7399f426868d95616b0ae34be0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad20c0ccb48d2f9c56e7cf1af805e26e6"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#ad20c0ccb48d2f9c56e7cf1af805e26e6">compute_uplift</a> (r_coord, r_timeuplift)</td></tr>
<tr class="memdesc:ad20c0ccb48d2f9c56e7cf1af805e26e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes the interpolated uplift at the given coordinates  <a href="#ad20c0ccb48d2f9c56e7cf1af805e26e6">More...</a><br /></td></tr>
<tr class="separator:ad20c0ccb48d2f9c56e7cf1af805e26e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7d31a77a36224e67e79ba36fcbe5ff6"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#aa7d31a77a36224e67e79ba36fcbe5ff6">initialize_source</a> (c_filename, r_lonrange, r_latrange, i_nlonpoints, i_nlatpoints, i_smoothwidth)</td></tr>
<tr class="memdesc:aa7d31a77a36224e67e79ba36fcbe5ff6"><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes the source and uplift  <a href="#aa7d31a77a36224e67e79ba36fcbe5ff6">More...</a><br /></td></tr>
<tr class="separator:aa7d31a77a36224e67e79ba36fcbe5ff6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d63572694b25b72dd32624daf39ec1b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a0d63572694b25b72dd32624daf39ec1b">write_uplift_coards</a> (c_filename, c_tunits, c_xunits, c_yunits, c_zunits)</td></tr>
<tr class="memdesc:a0d63572694b25b72dd32624daf39ec1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">writes the uplift into a COARDS file  <a href="#a0d63572694b25b72dd32624daf39ec1b">More...</a><br /></td></tr>
<tr class="separator:a0d63572694b25b72dd32624daf39ec1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0b5ae54bdb1ffd7d489226eafbb03d2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#aa0b5ae54bdb1ffd7d489226eafbb03d2">add_uplift</a> (r_subfaultparam, i_timeslice)</td></tr>
<tr class="memdesc:aa0b5ae54bdb1ffd7d489226eafbb03d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the uplift to the initialized source.  <a href="#aa0b5ae54bdb1ffd7d489226eafbb03d2">More...</a><br /></td></tr>
<tr class="separator:aa0b5ae54bdb1ffd7d489226eafbb03d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f60cbbf5662f8ddea1bbc1695b69649"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a0f60cbbf5662f8ddea1bbc1695b69649">strike_slip</a> (y1, y2, ang_dip, q)</td></tr>
<tr class="memdesc:a0f60cbbf5662f8ddea1bbc1695b69649"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the strike slip used in Okada's model (1985)  <a href="#a0f60cbbf5662f8ddea1bbc1695b69649">More...</a><br /></td></tr>
<tr class="separator:a0f60cbbf5662f8ddea1bbc1695b69649"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6b6749585585cc4111323488ddea397"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#ad6b6749585585cc4111323488ddea397">dip_slip</a> (y1, y2, ang_dip, q)</td></tr>
<tr class="memdesc:ad6b6749585585cc4111323488ddea397"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the dip slip used in Okada's model (1985)  <a href="#ad6b6749585585cc4111323488ddea397">More...</a><br /></td></tr>
<tr class="separator:ad6b6749585585cc4111323488ddea397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a075120c43a3eb3db03d30eb478cd95a2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a075120c43a3eb3db03d30eb478cd95a2">netcdf_error</a> (status)</td></tr>
<tr class="memdesc:a075120c43a3eb3db03d30eb478cd95a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">prints error message  <a href="#a075120c43a3eb3db03d30eb478cd95a2">More...</a><br /></td></tr>
<tr class="separator:a075120c43a3eb3db03d30eb478cd95a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae73c6d0f3a27102158a449d7eecb5909"><td class="memItemLeft" align="right" valign="top">integer(kind=grid_si)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#ae73c6d0f3a27102158a449d7eecb5909">i_nlonpts</a></td></tr>
<tr class="separator:ae73c6d0f3a27102158a449d7eecb5909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed975743bf40a527224090928d74b030"><td class="memItemLeft" align="right" valign="top">integer(kind=grid_si)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#aed975743bf40a527224090928d74b030">i_nlatpts</a></td></tr>
<tr class="separator:aed975743bf40a527224090928d74b030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d173387194c3234eee4e64695352ceb"><td class="memItemLeft" align="right" valign="top">integer(kind=grid_si)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a2d173387194c3234eee4e64695352ceb">i_ntimepts</a></td></tr>
<tr class="separator:a2d173387194c3234eee4e64695352ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d3734eaeff02157ebfb15d6a920f0fa"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr), dimension(:,:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a3d3734eaeff02157ebfb15d6a920f0fa">r_z</a></td></tr>
<tr class="separator:a3d3734eaeff02157ebfb15d6a920f0fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb6352125c55323c5a0802ad44eb9667"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#afb6352125c55323c5a0802ad44eb9667">r_lat</a></td></tr>
<tr class="separator:afb6352125c55323c5a0802ad44eb9667"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9fb067bb9eee71e59a06f88debbd741"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#ac9fb067bb9eee71e59a06f88debbd741">r_lon</a></td></tr>
<tr class="separator:ac9fb067bb9eee71e59a06f88debbd741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d9a305afb32df94ae3ecb9c82eb92de"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a8d9a305afb32df94ae3ecb9c82eb92de">r_time</a></td></tr>
<tr class="separator:a8d9a305afb32df94ae3ecb9c82eb92de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d1a3e1eec49b9da551a6af99ea51639"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a7d1a3e1eec49b9da551a6af99ea51639">r_earth</a> = 6.3675e6_GRID_SR</td></tr>
<tr class="separator:a7d1a3e1eec49b9da551a6af99ea51639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f028b8a6030e63382fd97b4f0efcaa"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#ae5f028b8a6030e63382fd97b4f0efcaa">r_poisson</a> = 0.25_GRID_SR</td></tr>
<tr class="separator:ae5f028b8a6030e63382fd97b4f0efcaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58b19294ad894596e69c03d9d592bf52"><td class="memItemLeft" align="right" valign="top">integer(kind=grid_si), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a58b19294ad894596e69c03d9d592bf52">i_faultdim</a> = 12</td></tr>
<tr class="separator:a58b19294ad894596e69c03d9d592bf52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddbcaabc8a3a0d1e3389a423e014445"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a0ddbcaabc8a3a0d1e3389a423e014445">r_dlon</a></td></tr>
<tr class="separator:a0ddbcaabc8a3a0d1e3389a423e014445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cd00a45551a896e01f58177997aa131"><td class="memItemLeft" align="right" valign="top">real(kind=grid_sr)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemisc__eqsource.html#a2cd00a45551a896e01f58177997aa131">r_dlat</a></td></tr>
<tr class="separator:a2cd00a45551a896e01f58177997aa131"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>reads pre-calculated uplift from a COARDS-file </p>
<p>calculates resulting seafloor displacement computed by the Okada (1985) model from given finite fault data</p>
<dl class="section note"><dt>Note</dt><dd>the input file must have the following structure: Header/comment lines are denoted by a # First line has to be NUM_FAULTS followed by a line defining the number of subfaults. Preceding the data, there has to be a line with FAULT_PARAMETERS indicating that the data follows in the next line. The data then has to yield NUM_FAULTS rows with i_faultdim entries (usually 10 or 12).</dd></dl>
<p>The columns have to be aranged in the following way (12 inputs): 1) latitude in deg, 2) longitude in deg, 3) depth in m, 4) slip in m, 5) rake in deg, 6) strike in deg, 7) dip in deg, 8) intial rupture time in s, 9) starting rise time in s, 10) ending rise time in s, 11) length of rupture in m and 12) width of rupture in m</p>
<p>As of yet, initial rupture time and rising times have not been implemented (07/2016) </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa0b5ae54bdb1ffd7d489226eafbb03d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0b5ae54bdb1ffd7d489226eafbb03d2">&#9670;&nbsp;</a></span>add_uplift()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine misc_eqsource::add_uplift </td>
          <td>(</td>
          <td class="paramtype">real(kind = grid_sr), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>r_subfaultparam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer (kind = grid_si), intent(in)&#160;</td>
          <td class="paramname"><em>i_timeslice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds the uplift to the initialized source. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">r_subfaultparam</td><td>fault data from input file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_timeslice</td><td>time slice </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad20c0ccb48d2f9c56e7cf1af805e26e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad20c0ccb48d2f9c56e7cf1af805e26e6">&#9670;&nbsp;</a></span>compute_uplift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind = grid_sr) function, public misc_eqsource::compute_uplift </td>
          <td>(</td>
          <td class="paramtype">real (kind = grid_sr), dimension(grid_dimension)&#160;</td>
          <td class="paramname"><em>r_coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind = grid_sr)&#160;</td>
          <td class="paramname"><em>r_timeuplift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes the interpolated uplift at the given coordinates </p>
<p>computes the uplift and interpolates according to the Okada model (1985)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">r_coord</td><td>coordinate values for uplift calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_timeuplift</td><td>time at which uplift is needed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>calculated uplift </dd></dl>

</div>
</div>
<a id="ad6b6749585585cc4111323488ddea397"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6b6749585585cc4111323488ddea397">&#9670;&nbsp;</a></span>dip_slip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind = grid_sr) function misc_eqsource::dip_slip </td>
          <td>(</td>
          <td class="paramtype">real(kind = grid_sr), intent(in)&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind = grid_sr), intent(in)&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind = grid_sr), intent(in)&#160;</td>
          <td class="paramname"><em>ang_dip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind = grid_sr), intent(in)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the dip slip used in Okada's model (1985) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">y1</td><td>distance along strike </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y2</td><td>distance up the fault plane </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ang_dip</td><td>dip of fault </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>depth up the fault plane </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>displacement in z direction </dd></dl>

</div>
</div>
<a id="a94e17f7399f426868d95616b0ae34be0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94e17f7399f426868d95616b0ae34be0">&#9670;&nbsp;</a></span>initialize_source() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public misc_eqsource::initialize_source </td>
          <td>(</td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>c_filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind = grid_sr), dimension(2), intent(in), optional&#160;</td>
          <td class="paramname"><em>r_dummy1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind = grid_sr), dimension(2), intent(in), optional&#160;</td>
          <td class="paramname"><em>r_dummy2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer (kind = grid_si), intent(in), optional&#160;</td>
          <td class="paramname"><em>i_dummy1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer (kind = grid_si), intent(in), optional&#160;</td>
          <td class="paramname"><em>i_dummy2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer (kind = grid_si), intent(in), optional&#160;</td>
          <td class="paramname"><em>i_dummy3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initializes the source and uplift </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c_filename</td><td>uplift data input file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_dummy1</td><td>dummy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_dummy2</td><td>dummy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_dummy1</td><td>dummy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_dummy2</td><td>dummy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_dummy3</td><td>dummy </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>the only actual input is the filename but all dummies are needed to keep the initialize_source routine consistent with other modules </dd></dl>

</div>
</div>
<a id="aa7d31a77a36224e67e79ba36fcbe5ff6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7d31a77a36224e67e79ba36fcbe5ff6">&#9670;&nbsp;</a></span>initialize_source() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public misc_eqsource::initialize_source </td>
          <td>(</td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>c_filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind = grid_sr), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>r_lonrange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real (kind = grid_sr), dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>r_latrange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer (kind = grid_si), intent(in)&#160;</td>
          <td class="paramname"><em>i_nlonpoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer (kind = grid_si), intent(in)&#160;</td>
          <td class="paramname"><em>i_nlatpoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer (kind = grid_si), intent(in)&#160;</td>
          <td class="paramname"><em>i_smoothwidth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initializes the source and uplift </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c_filename</td><td>uplift data input file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_lonrange</td><td>lon. range in which the uplift is calculated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">r_latrange</td><td>lat. range in which the uplift is calculated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_nlonpoints</td><td>amount of longitude points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_nlatpoints</td><td>amount of latitude points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_smoothwidth</td><td>amount of smoothing iterations </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>for the time being, we do not consider time-dependent uplifts! </dd></dl>

</div>
</div>
<a id="a075120c43a3eb3db03d30eb478cd95a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a075120c43a3eb3db03d30eb478cd95a2">&#9670;&nbsp;</a></span>netcdf_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine misc_eqsource::netcdf_error </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>prints error message </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">status</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0f60cbbf5662f8ddea1bbc1695b69649"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f60cbbf5662f8ddea1bbc1695b69649">&#9670;&nbsp;</a></span>strike_slip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind = grid_sr) function misc_eqsource::strike_slip </td>
          <td>(</td>
          <td class="paramtype">real(kind = grid_sr), intent(in)&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind = grid_sr), intent(in)&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind = grid_sr), intent(in)&#160;</td>
          <td class="paramname"><em>ang_dip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind = grid_sr), intent(in)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the strike slip used in Okada's model (1985) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">y1</td><td>distance along strike </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y2</td><td>distance up the fault plane </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ang_dip</td><td>dip of fault </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>depth up the fault plane </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>displacement in z direction </dd></dl>

</div>
</div>
<a id="a0d63572694b25b72dd32624daf39ec1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d63572694b25b72dd32624daf39ec1b">&#9670;&nbsp;</a></span>write_uplift_coards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public misc_eqsource::write_uplift_coards </td>
          <td>(</td>
          <td class="paramtype">character (len = *), intent(in)&#160;</td>
          <td class="paramname"><em>c_filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character (len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>c_tunits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character (len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>c_xunits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character (len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>c_yunits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character (len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>c_zunits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>writes the uplift into a COARDS file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">c_filename</td><td>uplift data input file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c_tunits</td><td>units for time coordinate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c_xunits</td><td>units for x coordinate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c_yunits</td><td>units for y coordinate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">c_zunits</td><td>units for uplift </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a58b19294ad894596e69c03d9d592bf52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58b19294ad894596e69c03d9d592bf52">&#9670;&nbsp;</a></span>i_faultdim</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer (kind = grid_si), parameter misc_eqsource::i_faultdim = 12</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aed975743bf40a527224090928d74b030"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed975743bf40a527224090928d74b030">&#9670;&nbsp;</a></span>i_nlatpts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer (kind = grid_si) misc_eqsource::i_nlatpts</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae73c6d0f3a27102158a449d7eecb5909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae73c6d0f3a27102158a449d7eecb5909">&#9670;&nbsp;</a></span>i_nlonpts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer (kind = grid_si) misc_eqsource::i_nlonpts</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2d173387194c3234eee4e64695352ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d173387194c3234eee4e64695352ceb">&#9670;&nbsp;</a></span>i_ntimepts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer (kind = grid_si) misc_eqsource::i_ntimepts</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2cd00a45551a896e01f58177997aa131"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cd00a45551a896e01f58177997aa131">&#9670;&nbsp;</a></span>r_dlat</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind = grid_sr) misc_eqsource::r_dlat</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0ddbcaabc8a3a0d1e3389a423e014445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddbcaabc8a3a0d1e3389a423e014445">&#9670;&nbsp;</a></span>r_dlon</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind = grid_sr) misc_eqsource::r_dlon</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7d1a3e1eec49b9da551a6af99ea51639"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d1a3e1eec49b9da551a6af99ea51639">&#9670;&nbsp;</a></span>r_earth</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind = grid_sr), parameter misc_eqsource::r_earth = 6.3675e6_GRID_SR</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afb6352125c55323c5a0802ad44eb9667"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb6352125c55323c5a0802ad44eb9667">&#9670;&nbsp;</a></span>r_lat</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind = grid_sr), dimension(:), allocatable misc_eqsource::r_lat</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac9fb067bb9eee71e59a06f88debbd741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9fb067bb9eee71e59a06f88debbd741">&#9670;&nbsp;</a></span>r_lon</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind = grid_sr), dimension(:), allocatable misc_eqsource::r_lon</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae5f028b8a6030e63382fd97b4f0efcaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5f028b8a6030e63382fd97b4f0efcaa">&#9670;&nbsp;</a></span>r_poisson</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind = grid_sr), parameter misc_eqsource::r_poisson = 0.25_GRID_SR</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8d9a305afb32df94ae3ecb9c82eb92de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d9a305afb32df94ae3ecb9c82eb92de">&#9670;&nbsp;</a></span>r_time</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind = grid_sr), dimension(:), allocatable misc_eqsource::r_time</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3d3734eaeff02157ebfb15d6a920f0fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d3734eaeff02157ebfb15d6a920f0fa">&#9670;&nbsp;</a></span>r_z</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real (kind = grid_sr), dimension(:,:,:), allocatable misc_eqsource::r_z</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemisc__eqsource.html">misc_eqsource</a></li>
    <li class="footer">Generated on Mon Nov 5 2018 14:08:27 for StormFlash2d by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
